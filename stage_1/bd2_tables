-- Generated by Oracle SQL Developer Data Modeler 3.1.4.710
--   at:        2012-12-30 14:40:37 CET
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



CREATE TABLE Brands 
    ( 
     brand VARCHAR2 (20)  NOT NULL 
    ) 
;



ALTER TABLE Brands 
    ADD CONSTRAINT "Mark PK" PRIMARY KEY ( brand ) ;



CREATE TABLE Clients 
    ( 
     client_id NUMBER (5)  NOT NULL , 
     additional_address VARCHAR2 (500) , 
     street VARCHAR2 (30)  NOT NULL , 
     building_number NUMBER (3)  NOT NULL , 
     apartment_number NUMBER (4) , 
     postal_code NUMBER (5)  NOT NULL , 
     city VARCHAR2 (20)  NOT NULL , 
     phone_number VARCHAR2 (14)  NOT NULL , 
     email VARCHAR2 (50) , 
     first_name VARCHAR2 (20) , 
     last_name VARCHAR2 (30) , 
     pesel NUMBER (11) , 
     name VARCHAR2 (30) , 
     nip NUMBER (10) 
    ) 
;



ALTER TABLE Clients 
    ADD CONSTRAINT "Client PK" PRIMARY KEY ( client_id ) ;


ALTER TABLE Clients 
    ADD CONSTRAINT Key_2 UNIQUE ( phone_number ) ;


ALTER TABLE Clients 
    ADD CONSTRAINT Key_3 UNIQUE ( email ) ;


ALTER TABLE Clients 
    ADD CONSTRAINT Key_1 UNIQUE ( pesel ) ;


ALTER TABLE Clients 
    ADD CONSTRAINT Key_1 UNIQUE ( nip ) ;



CREATE TABLE Complementation_Items 
    ( 
     amount NUMBER (4)  NOT NULL , 
     unit_price NUMBER (7,2)  NOT NULL , 
     complementation_id NUMBER (5)  NOT NULL , 
     part_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE Complementation_Items 
    ADD CONSTRAINT "Complementation_Item PK" PRIMARY KEY ( complementation_id, part_id ) ;



CREATE TABLE Complementations 
    ( 
     complementation_id NUMBER (5)  NOT NULL , 
     cost NUMBER (8,2)  NOT NULL , 
     complementation_date DATE  NOT NULL , 
     remark VARCHAR2 (500) , 
     provider_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE Complementations 
    ADD CONSTRAINT "Complement PK" PRIMARY KEY ( complementation_id ) ;



CREATE TABLE Employees 
    ( 
     employee_id NUMBER (5)  NOT NULL , 
     position VARCHAR2 (20)  NOT NULL , 
     first_name VARCHAR2 (20)  NOT NULL , 
     last_name VARCHAR2 (30)  NOT NULL , 
     salary NUMBER (7,2)  NOT NULL , 
     phone_number VARCHAR2 (14)  NOT NULL , 
     address VARCHAR2 (500) 
    ) 
;



ALTER TABLE Employees 
    ADD CONSTRAINT "Employee PK" PRIMARY KEY ( employee_id ) ;


ALTER TABLE Employees 
    ADD CONSTRAINT Key_2 UNIQUE ( phone_number ) ;



CREATE TABLE Orders 
    ( 
     client_id NUMBER (5)  NOT NULL , 
     service_type VARCHAR2 (30)  NOT NULL , 
     vehicle_id NUMBER (5)  NOT NULL , 
     order_id NUMBER (5)  NOT NULL , 
     order_date DATE  NOT NULL , 
     value NUMBER (7,2)  NOT NULL , 
     note VARCHAR2 (1000) , 
     service_id NUMBER (5)  NOT NULL 
    ) 
;


CREATE UNIQUE INDEX Order__IDX ON Orders 
    ( 
     service_id ASC 
    ) 
;

ALTER TABLE Orders 
    ADD CONSTRAINT "Order PK" PRIMARY KEY ( order_id ) ;



CREATE TABLE Part_Types 
    ( 
     part_type VARCHAR2 (30)  NOT NULL 
    ) 
;



ALTER TABLE Part_Types 
    ADD CONSTRAINT "Part_Type PK" PRIMARY KEY ( part_type ) ;



CREATE TABLE Parts 
    ( 
     part_id NUMBER (5)  NOT NULL , 
     name VARCHAR2 (30)  NOT NULL , 
     description VARCHAR2 (500) , 
     part_type VARCHAR2 (30)  NOT NULL 
    ) 
;



ALTER TABLE Parts 
    ADD CONSTRAINT "Part PK" PRIMARY KEY ( part_id ) ;



CREATE TABLE Positions 
    ( 
     position VARCHAR2 (20)  NOT NULL 
    ) 
;



ALTER TABLE Positions 
    ADD CONSTRAINT "Position PK" PRIMARY KEY ( position ) ;



CREATE TABLE Providers 
    ( 
     provider_id NUMBER (5)  NOT NULL , 
     name VARCHAR2 (30)  NOT NULL , 
     nip NUMBER (10)  NOT NULL , 
     phone_number VARCHAR2 (14)  NOT NULL , 
     address VARCHAR2 (500) 
    ) 
;



ALTER TABLE Providers 
    ADD CONSTRAINT "Provider PK" PRIMARY KEY ( provider_id ) ;


ALTER TABLE Providers 
    ADD CONSTRAINT Key_2 UNIQUE ( nip ) ;


ALTER TABLE Providers 
    ADD CONSTRAINT Key_3 UNIQUE ( phone_number ) ;



CREATE TABLE Service_Types 
    ( 
     service_type VARCHAR2 (30)  NOT NULL , 
     default_charge NUMBER (7,2) 
    ) 
;



ALTER TABLE Service_Types 
    ADD CONSTRAINT "Service_Type PK" PRIMARY KEY ( service_type ) ;



CREATE TABLE Services 
    ( 
     service_id NUMBER (5)  NOT NULL , 
     order_id NUMBER (5)  NOT NULL , 
     employee_id NUMBER (5)  NOT NULL , 
     begin_date DATE  NOT NULL , 
     end_time DATE , 
     cost NUMBER (7,5)  NOT NULL , 
     "comment" VARCHAR2 (1000) 
    ) 
;


CREATE UNIQUE INDEX Service__IDX ON Services 
    ( 
     order_id ASC 
    ) 
;

ALTER TABLE Services 
    ADD CONSTRAINT "Service PK" PRIMARY KEY ( service_id ) ;



CREATE TABLE Vehicles 
    ( 
     client_id NUMBER (5)  NOT NULL , 
     vehicle_id NUMBER (5)  NOT NULL , 
     vin_number VARCHAR2 (17)  NOT NULL , 
     production_date DATE , 
     type VARCHAR2 (20) , 
     brand VARCHAR2 (20)  NOT NULL 
    ) 
;



ALTER TABLE Vehicles 
    ADD CONSTRAINT "Vehicle PK" PRIMARY KEY ( vehicle_id ) ;


ALTER TABLE Vehicles 
    ADD CONSTRAINT Key_2 UNIQUE ( vin_number ) ;



CREATE TABLE services_parts 
    ( 
     Part_part_id NUMBER (5)  NOT NULL , 
     Service_service_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE services_parts 
    ADD CONSTRAINT services_parts__IDX PRIMARY KEY ( Part_part_id, Service_service_id ) ;




ALTER TABLE services_parts 
    ADD CONSTRAINT FK_ASS_13 FOREIGN KEY 
    ( 
     Part_part_id
    ) 
    REFERENCES Parts 
    ( 
     part_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE services_parts 
    ADD CONSTRAINT FK_ASS_14 FOREIGN KEY 
    ( 
     Service_service_id
    ) 
    REFERENCES Services 
    ( 
     service_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE Orders 
    ADD CONSTRAINT clients_orders FOREIGN KEY 
    ( 
     client_id
    ) 
    REFERENCES Clients 
    ( 
     client_id
    ) 
;


ALTER TABLE Vehicles 
    ADD CONSTRAINT clients_vehicles FOREIGN KEY 
    ( 
     client_id
    ) 
    REFERENCES Clients 
    ( 
     client_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE Complementation_Items 
    ADD CONSTRAINT complementations_compl_items FOREIGN KEY 
    ( 
     complementation_id
    ) 
    REFERENCES Complementations 
    ( 
     complementation_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE Employees 
    ADD CONSTRAINT employees_positions FOREIGN KEY 
    ( 
     position
    ) 
    REFERENCES Positions 
    ( 
     position
    ) 
;


ALTER TABLE Orders 
    ADD CONSTRAINT orders_service_types FOREIGN KEY 
    ( 
     service_type
    ) 
    REFERENCES Service_Types 
    ( 
     service_type
    ) 
;


ALTER TABLE Services 
    ADD CONSTRAINT orders_services FOREIGN KEY 
    ( 
     order_id
    ) 
    REFERENCES Orders 
    ( 
     order_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE Orders 
    ADD CONSTRAINT orders_services FOREIGN KEY 
    ( 
     service_id
    ) 
    REFERENCES Services 
    ( 
     service_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE Orders 
    ADD CONSTRAINT orders_vehicles FOREIGN KEY 
    ( 
     vehicle_id
    ) 
    REFERENCES Vehicles 
    ( 
     vehicle_id
    ) 
;


ALTER TABLE Complementation_Items 
    ADD CONSTRAINT parts_complementation_items FOREIGN KEY 
    ( 
     part_id
    ) 
    REFERENCES Parts 
    ( 
     part_id
    ) 
;


ALTER TABLE Parts 
    ADD CONSTRAINT parts_part_types FOREIGN KEY 
    ( 
     part_type
    ) 
    REFERENCES Part_Types 
    ( 
     part_type
    ) 
;


ALTER TABLE Complementations 
    ADD CONSTRAINT providers_complementations FOREIGN KEY 
    ( 
     provider_id
    ) 
    REFERENCES Providers 
    ( 
     provider_id
    ) 
;


ALTER TABLE Services 
    ADD CONSTRAINT services_employees FOREIGN KEY 
    ( 
     employee_id
    ) 
    REFERENCES Employees 
    ( 
     employee_id
    ) 
;


ALTER TABLE Vehicles 
    ADD CONSTRAINT vehicles_brands FOREIGN KEY 
    ( 
     brand
    ) 
    REFERENCES Brands 
    ( 
     brand
    ) 
;

CREATE OR REPLACE VIEW Companies AS
SELECT Clients.client_id,
  Clients.additional_address,
  Clients.street,
  Clients.building_number,
  Clients.apartment_number,
  Clients.postal_code,
  Clients.city,
  Clients.phone_number,
  Clients.email,
  Clients.name,
  Clients.nip
FROM Clients ;



CREATE OR REPLACE VIEW Persons AS
SELECT Clients.client_id,
  Clients.additional_address,
  Clients.street,
  Clients.building_number,
  Clients.apartment_number,
  Clients.postal_code,
  Clients.city,
  Clients.email,
  Clients.phone_number,
  Clients.first_name,
  Clients.last_name,
  Clients.pesel
FROM Clients ;





-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            14
-- CREATE INDEX                             2
-- ALTER TABLE                             37
-- CREATE VIEW                              2
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE STRUCTURED TYPE                   0
-- CREATE COLLECTION TYPE                   0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
