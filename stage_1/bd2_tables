-- Generated by Oracle SQL Developer Data Modeler 3.1.4.710
--   at:        2013-02-01 17:18:14 CET
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



DROP VIEW Company 
;
DROP VIEW Person 
;
DROP TABLE Brand CASCADE CONSTRAINTS 
;
DROP TABLE Client CASCADE CONSTRAINTS 
;
DROP TABLE Complementation CASCADE CONSTRAINTS 
;
DROP TABLE Complementation_position CASCADE CONSTRAINTS 
;
DROP TABLE Employee CASCADE CONSTRAINTS 
;
DROP TABLE MODEL CASCADE CONSTRAINTS 
;
DROP TABLE Order_t CASCADE CONSTRAINTS 
;
DROP TABLE PARAMETER CASCADE CONSTRAINTS 
;
DROP TABLE PARAMETER_UNIT CASCADE CONSTRAINTS 
;
DROP TABLE PART_PARAMETER CASCADE CONSTRAINTS 
;
DROP TABLE PART_PRODUCER CASCADE CONSTRAINTS 
;
DROP TABLE PART_VERSION CASCADE CONSTRAINTS 
;
DROP TABLE PROVIDER_OFFER CASCADE CONSTRAINTS 
;
DROP TABLE Part CASCADE CONSTRAINTS 
;
DROP TABLE Part_Type CASCADE CONSTRAINTS 
;
DROP TABLE Position CASCADE CONSTRAINTS 
;
DROP TABLE Provider CASCADE CONSTRAINTS 
;
DROP TABLE Service CASCADE CONSTRAINTS 
;
DROP TABLE Service_Type CASCADE CONSTRAINTS 
;
DROP TABLE UNIT CASCADE CONSTRAINTS 
;
DROP TABLE VEHICLE_PARAMETER CASCADE CONSTRAINTS 
;
DROP TABLE VEHICLE_VERSION CASCADE CONSTRAINTS 
;
DROP TABLE Vehicle CASCADE CONSTRAINTS 
;
DROP TABLE delivery CASCADE CONSTRAINTS 
;
DROP TABLE part_instance CASCADE CONSTRAINTS 
;
CREATE TABLE Brand 
    ( 
     brand VARCHAR2 (20)  NOT NULL 
    ) 
;



ALTER TABLE Brand 
    ADD CONSTRAINT "Mark PK" PRIMARY KEY ( brand ) ;



CREATE TABLE Client 
    ( 
     client_id NUMBER (5)  NOT NULL , 
     additional_address VARCHAR2 (500) , 
     street VARCHAR2 (30)  NOT NULL , 
     building_number NUMBER (3)  NOT NULL , 
     apartment_number NUMBER (4) , 
     postal_code VARCHAR2 (5)  NOT NULL , 
     city VARCHAR2 (20)  NOT NULL , 
     phone_number VARCHAR2 (14)  NOT NULL , 
     email VARCHAR2 (50)  NOT NULL , 
     first_name VARCHAR2 (20) , 
     last_name VARCHAR2 (30) , 
     pesel NUMBER (11) , 
     name VARCHAR2 (30) , 
     nip NUMBER (10) 
    ) 
;



ALTER TABLE Client 
    ADD CONSTRAINT "Client PK" PRIMARY KEY ( client_id ) ;


ALTER TABLE Client 
    ADD CONSTRAINT Key_2a UNIQUE ( phone_number ) ;


ALTER TABLE Client 
    ADD CONSTRAINT Key_3 UNIQUE ( email ) ;


ALTER TABLE Client 
    ADD CONSTRAINT Key_1 UNIQUE ( pesel ) ;


ALTER TABLE Client 
    ADD CONSTRAINT Key_1v1 UNIQUE ( nip ) ;



CREATE TABLE Complementation 
    ( 
     complementation_id NUMBER (5)  NOT NULL , 
     cost NUMBER (8,2)  NOT NULL , 
     complementation_date DATE  NOT NULL , 
     remark VARCHAR2 (500) , 
     provider_id NUMBER (5)  NOT NULL , 
     delivery_id NUMBER (5) 
    ) 
;



ALTER TABLE Complementation 
    ADD CONSTRAINT "Complement PK" PRIMARY KEY ( complementation_id ) ;



CREATE TABLE Complementation_position 
    ( 
     amount NUMBER (4)  NOT NULL , 
     position_price NUMBER (7,2)  NOT NULL , 
     complementation_id NUMBER (5)  NOT NULL , 
     catalog_number NUMBER (5)  NOT NULL , 
     name1 VARCHAR2 (30)  NOT NULL , 
     provider_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE Complementation_position 
    ADD CONSTRAINT "Complementation_Item PK" PRIMARY KEY ( complementation_id, catalog_number, name1, provider_id ) ;



CREATE TABLE Employee 
    ( 
     employee_id NUMBER (5)  NOT NULL , 
     position VARCHAR2 (20)  NOT NULL , 
     first_name VARCHAR2 (20)  NOT NULL , 
     last_name VARCHAR2 (30)  NOT NULL , 
     salary NUMBER (7,2)  NOT NULL , 
     phone_number VARCHAR2 (14)  NOT NULL , 
     address VARCHAR2 (500) 
    ) 
;



ALTER TABLE Employee 
    ADD CONSTRAINT "Employee PK" PRIMARY KEY ( employee_id ) ;


ALTER TABLE Employee 
    ADD CONSTRAINT Key_2d UNIQUE ( phone_number ) ;



CREATE TABLE MODEL 
    ( 
     model VARCHAR2 (20)  NOT NULL , 
     brand VARCHAR2 (20)  NOT NULL 
    ) 
;



ALTER TABLE MODEL 
    ADD CONSTRAINT "MODEL PK" PRIMARY KEY ( model ) ;



CREATE TABLE Order_t 
    ( 
     client_id NUMBER (5)  NOT NULL , 
     service_type VARCHAR2 (30)  NOT NULL , 
     vehicle_id NUMBER (5)  NOT NULL , 
     order_id NUMBER (5)  NOT NULL , 
     order_date DATE  NOT NULL , 
     value NUMBER (7,2)  NOT NULL , 
     note VARCHAR2 (1000) 
    ) 
;



ALTER TABLE Order_t 
    ADD CONSTRAINT "Order PK" PRIMARY KEY ( order_id ) ;



CREATE TABLE PARAMETER 
    ( 
     parameter_id NUMBER (5)  NOT NULL , 
     name VARCHAR2 (20)  NOT NULL , 
     data_type CHAR (1)  NOT NULL , 
     description VARCHAR2 (1000) 
    ) 
;



ALTER TABLE PARAMETER 
    ADD CONSTRAINT "PARAMETERS PK" PRIMARY KEY ( parameter_id ) ;



CREATE TABLE PARAMETER_UNIT 
    ( 
     unit VARCHAR2 (10)  NOT NULL , 
     isBasic CHAR (1) , 
     parameter_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE PARAMETER_UNIT 
    ADD CONSTRAINT "PARAMETER_UNIT PK" PRIMARY KEY ( unit, parameter_id ) ;



CREATE TABLE PART_PARAMETER 
    ( 
     unit VARCHAR2 (10) , 
     parameter_id1 NUMBER (5) , 
     param_instance_id NUMBER (5)  NOT NULL , 
     name VARCHAR2 (20) , 
     numeric_value NUMBER (10) , 
     text_value VARCHAR2 (50) , 
     catalog_number NUMBER (5)  NOT NULL , 
     name1 VARCHAR2 (30)  NOT NULL , 
     parameter_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE PART_PARAMETER 
    ADD CONSTRAINT "VEHICLE_PARAMETER PK" PRIMARY KEY ( param_instance_id ) ;


ALTER TABLE PART_PARAMETER 
    ADD CONSTRAINT "PART_PARAMETER PK" UNIQUE ( catalog_number , name1 ) ;



CREATE TABLE PART_PRODUCER 
    ( 
     name VARCHAR2 (30)  NOT NULL , 
     address VARCHAR2 (50)  NOT NULL , 
     description VARCHAR2 (500) 
    ) 
;



ALTER TABLE PART_PRODUCER 
    ADD CONSTRAINT "PART_PRODUCER PK" PRIMARY KEY ( name ) ;



CREATE TABLE PART_VERSION 
    ( 
     part_type VARCHAR2 (30)  NOT NULL , 
     part_number NUMBER (10)  NOT NULL , 
     vversion_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE PART_VERSION 
    ADD CONSTRAINT "PART_VERSION PK" PRIMARY KEY ( part_number ) ;



CREATE TABLE PROVIDER_OFFER 
    ( 
     catalog_number NUMBER (5)  NOT NULL , 
     name1 VARCHAR2 (30)  NOT NULL , 
     price NUMBER (5)  NOT NULL , 
     provider_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE PROVIDER_OFFER 
    ADD CONSTRAINT "PROVIDER_OFFER PK" PRIMARY KEY ( catalog_number, name1, provider_id ) ;



CREATE TABLE Part 
    ( 
     catalog_number NUMBER (5)  NOT NULL , 
     name VARCHAR2 (30)  NOT NULL , 
     description VARCHAR2 (500) , 
     default_price NUMBER (5)  NOT NULL , 
     part_number NUMBER (10)  NOT NULL , 
     name1 VARCHAR2 (30)  NOT NULL 
    ) 
;



ALTER TABLE Part 
    ADD CONSTRAINT "Part PK" PRIMARY KEY ( catalog_number, name1 ) ;



CREATE TABLE Part_Type 
    ( 
     part_type VARCHAR2 (30)  NOT NULL 
    ) 
;



ALTER TABLE Part_Type 
    ADD CONSTRAINT "Part_Type PK" PRIMARY KEY ( part_type ) ;



CREATE TABLE Position 
    ( 
     position VARCHAR2 (20)  NOT NULL 
    ) 
;



ALTER TABLE Position 
    ADD CONSTRAINT "Position PK" PRIMARY KEY ( position ) ;



CREATE TABLE Provider 
    ( 
     provider_id NUMBER (5)  NOT NULL , 
     name VARCHAR2 (30)  NOT NULL , 
     nip NUMBER (10)  NOT NULL , 
     phone_number VARCHAR2 (14)  NOT NULL , 
     address VARCHAR2 (500) 
    ) 
;



ALTER TABLE Provider 
    ADD CONSTRAINT "Provider PK" PRIMARY KEY ( provider_id ) ;


ALTER TABLE Provider 
    ADD CONSTRAINT Key_2b UNIQUE ( nip ) ;


ALTER TABLE Provider 
    ADD CONSTRAINT Key_3b UNIQUE ( phone_number ) ;



CREATE TABLE Service 
    ( 
     service_id NUMBER (5)  NOT NULL , 
     order_id NUMBER (5)  NOT NULL , 
     employee_id NUMBER (5)  NOT NULL , 
     begin_date DATE  NOT NULL , 
     end_time DATE , 
     cost NUMBER (7,5)  NOT NULL , 
     "comment" VARCHAR2 (1000) 
    ) 
;


CREATE UNIQUE INDEX Service__IDX ON Service 
    ( 
     order_id ASC 
    ) 
;

ALTER TABLE Service 
    ADD CONSTRAINT "Service PK" PRIMARY KEY ( service_id ) ;



CREATE TABLE Service_Type 
    ( 
     service_type VARCHAR2 (30)  NOT NULL , 
     default_charge NUMBER (7,2) 
    ) 
;



ALTER TABLE Service_Type 
    ADD CONSTRAINT "Service_Type PK" PRIMARY KEY ( service_type ) ;



CREATE TABLE UNIT 
    ( 
     unit VARCHAR2 (10)  NOT NULL 
    ) 
;



ALTER TABLE UNIT 
    ADD CONSTRAINT "UNIT PK" PRIMARY KEY ( unit ) ;



CREATE TABLE VEHICLE_PARAMETER 
    ( 
     unit VARCHAR2 (10) , 
     parameter_id1 NUMBER (5) , 
     param_instance_id NUMBER (5)  NOT NULL , 
     name VARCHAR2 (20) , 
     numeric_value NUMBER (10) , 
     text_value VARCHAR2 (50) , 
     vversion_id NUMBER (5)  NOT NULL , 
     parameter_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE VEHICLE_PARAMETER 
    ADD CONSTRAINT "VEHICLE_PARAMETER0 PK" PRIMARY KEY ( param_instance_id ) ;


ALTER TABLE VEHICLE_PARAMETER 
    ADD CONSTRAINT "VEHICLE_PARAMETER PKv2" UNIQUE ( vversion_id ) ;



CREATE TABLE VEHICLE_VERSION 
    ( 
     model VARCHAR2 (20)  NOT NULL , 
     vversion_id NUMBER (5)  NOT NULL , 
     brand VARCHAR2 (20)  NOT NULL 
    ) 
;



ALTER TABLE VEHICLE_VERSION 
    ADD CONSTRAINT "VEHICLE_VERSION PK" PRIMARY KEY ( vversion_id ) ;



CREATE TABLE Vehicle 
    ( 
     client_id NUMBER (5)  NOT NULL , 
     vehicle_id NUMBER (5)  NOT NULL , 
     vin_number VARCHAR2 (17)  NOT NULL , 
     registration VARCHAR2 (10)  NOT NULL , 
     production_date DATE  NOT NULL , 
     vversion_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE Vehicle 
    ADD CONSTRAINT "Vehicle PK" PRIMARY KEY ( vehicle_id ) ;


ALTER TABLE Vehicle 
    ADD CONSTRAINT Key_2f UNIQUE ( vin_number ) ;


ALTER TABLE Vehicle 
    ADD CONSTRAINT unique_registration UNIQUE ( registration ) ;



CREATE TABLE delivery 
    ( 
     delivery_id NUMBER (5)  NOT NULL , 
     "date" DATE  NOT NULL 
    ) 
;



ALTER TABLE delivery 
    ADD CONSTRAINT "delivery PK" PRIMARY KEY ( delivery_id ) ;



CREATE TABLE part_instance 
    ( 
     serial_number NUMBER (5)  NOT NULL , 
     catalog_number NUMBER (5)  NOT NULL , 
     name1 VARCHAR2 (30)  NOT NULL , 
     price NUMBER (5,2)  NOT NULL , 
     service_id NUMBER (5) , 
     delivery_id NUMBER (5)  NOT NULL 
    ) 
;



ALTER TABLE part_instance 
    ADD CONSTRAINT "part_instance PK" PRIMARY KEY ( serial_number, catalog_number, name1 ) ;




ALTER TABLE PARAMETER_UNIT 
    ADD CONSTRAINT Relation_22 FOREIGN KEY 
    ( 
     unit
    ) 
    REFERENCES UNIT 
    ( 
     unit
    ) 
;


ALTER TABLE PARAMETER_UNIT 
    ADD CONSTRAINT Relation_25 FOREIGN KEY 
    ( 
     parameter_id
    ) 
    REFERENCES PARAMETER 
    ( 
     parameter_id
    ) 
;


ALTER TABLE PART_PARAMETER 
    ADD CONSTRAINT Relation_26 FOREIGN KEY 
    ( 
     unit,
     parameter_id1
    ) 
    REFERENCES PARAMETER_UNIT 
    ( 
     unit,
     parameter_id
    ) 
;


ALTER TABLE VEHICLE_PARAMETER 
    ADD CONSTRAINT Relation_260 FOREIGN KEY 
    ( 
     unit,
     parameter_id1
    ) 
    REFERENCES PARAMETER_UNIT 
    ( 
     unit,
     parameter_id
    ) 
;


ALTER TABLE VEHICLE_VERSION 
    ADD CONSTRAINT Relation_28 FOREIGN KEY 
    ( 
     model
    ) 
    REFERENCES MODEL 
    ( 
     model
    ) 
;


ALTER TABLE Vehicle 
    ADD CONSTRAINT Relation_31 FOREIGN KEY 
    ( 
     vversion_id
    ) 
    REFERENCES VEHICLE_VERSION 
    ( 
     vversion_id
    ) 
;


ALTER TABLE PART_VERSION 
    ADD CONSTRAINT Relation_32 FOREIGN KEY 
    ( 
     part_type
    ) 
    REFERENCES Part_Type 
    ( 
     part_type
    ) 
;


ALTER TABLE PART_VERSION 
    ADD CONSTRAINT Relation_34 FOREIGN KEY 
    ( 
     vversion_id
    ) 
    REFERENCES VEHICLE_VERSION 
    ( 
     vversion_id
    ) 
;


ALTER TABLE Part 
    ADD CONSTRAINT Relation_35 FOREIGN KEY 
    ( 
     part_number
    ) 
    REFERENCES PART_VERSION 
    ( 
     part_number
    ) 
;


ALTER TABLE VEHICLE_VERSION 
    ADD CONSTRAINT Relation_37 FOREIGN KEY 
    ( 
     brand
    ) 
    REFERENCES Brand 
    ( 
     brand
    ) 
;


ALTER TABLE VEHICLE_PARAMETER 
    ADD CONSTRAINT Relation_39 FOREIGN KEY 
    ( 
     vversion_id
    ) 
    REFERENCES VEHICLE_VERSION 
    ( 
     vversion_id
    ) 
;


ALTER TABLE PART_PARAMETER 
    ADD CONSTRAINT Relation_40 FOREIGN KEY 
    ( 
     catalog_number,
     name1
    ) 
    REFERENCES Part 
    ( 
     catalog_number,
     name1
    ) 
;


ALTER TABLE Part 
    ADD CONSTRAINT Relation_41 FOREIGN KEY 
    ( 
     name1
    ) 
    REFERENCES PART_PRODUCER 
    ( 
     name
    ) 
;


ALTER TABLE PROVIDER_OFFER 
    ADD CONSTRAINT Relation_42 FOREIGN KEY 
    ( 
     catalog_number,
     name1
    ) 
    REFERENCES Part 
    ( 
     catalog_number,
     name1
    ) 
;


ALTER TABLE PROVIDER_OFFER 
    ADD CONSTRAINT Relation_43 FOREIGN KEY 
    ( 
     provider_id
    ) 
    REFERENCES Provider 
    ( 
     provider_id
    ) 
;


ALTER TABLE Complementation_position 
    ADD CONSTRAINT Relation_44 FOREIGN KEY 
    ( 
     catalog_number,
     name1,
     provider_id
    ) 
    REFERENCES PROVIDER_OFFER 
    ( 
     catalog_number,
     name1,
     provider_id
    ) 
;


ALTER TABLE Complementation 
    ADD CONSTRAINT Relation_45 FOREIGN KEY 
    ( 
     delivery_id
    ) 
    REFERENCES delivery 
    ( 
     delivery_id
    ) 
;


ALTER TABLE part_instance 
    ADD CONSTRAINT Relation_47 FOREIGN KEY 
    ( 
     delivery_id
    ) 
    REFERENCES delivery 
    ( 
     delivery_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE part_instance 
    ADD CONSTRAINT Relation_48 FOREIGN KEY 
    ( 
     catalog_number,
     name1
    ) 
    REFERENCES Part 
    ( 
     catalog_number,
     name1
    ) 
;


ALTER TABLE part_instance 
    ADD CONSTRAINT Relation_49 FOREIGN KEY 
    ( 
     service_id
    ) 
    REFERENCES Service 
    ( 
     service_id
    ) 
;


ALTER TABLE VEHICLE_PARAMETER 
    ADD CONSTRAINT Relation_50 FOREIGN KEY 
    ( 
     parameter_id
    ) 
    REFERENCES PARAMETER 
    ( 
     parameter_id
    ) 
;


ALTER TABLE PART_PARAMETER 
    ADD CONSTRAINT Relation_51 FOREIGN KEY 
    ( 
     parameter_id
    ) 
    REFERENCES PARAMETER 
    ( 
     parameter_id
    ) 
;


ALTER TABLE Order_t 
    ADD CONSTRAINT clients_orders FOREIGN KEY 
    ( 
     client_id
    ) 
    REFERENCES Client 
    ( 
     client_id
    ) 
;


ALTER TABLE Vehicle 
    ADD CONSTRAINT clients_vehicles FOREIGN KEY 
    ( 
     client_id
    ) 
    REFERENCES Client 
    ( 
     client_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE Complementation_position 
    ADD CONSTRAINT complementations_compl_items FOREIGN KEY 
    ( 
     complementation_id
    ) 
    REFERENCES Complementation 
    ( 
     complementation_id
    ) 
    ON DELETE CASCADE 
;


ALTER TABLE Employee 
    ADD CONSTRAINT employees_positions FOREIGN KEY 
    ( 
     position
    ) 
    REFERENCES Position 
    ( 
     position
    ) 
;


ALTER TABLE MODEL 
    ADD CONSTRAINT has FOREIGN KEY 
    ( 
     brand
    ) 
    REFERENCES Brand 
    ( 
     brand
    ) 
;


ALTER TABLE Order_t 
    ADD CONSTRAINT orders_service_types FOREIGN KEY 
    ( 
     service_type
    ) 
    REFERENCES Service_Type 
    ( 
     service_type
    ) 
;


ALTER TABLE Service 
    ADD CONSTRAINT orders_services FOREIGN KEY 
    ( 
     order_id
    ) 
    REFERENCES Order_t 
    ( 
     order_id
    ) 
;


ALTER TABLE Order_t 
    ADD CONSTRAINT orders_vehicles FOREIGN KEY 
    ( 
     vehicle_id
    ) 
    REFERENCES Vehicle 
    ( 
     vehicle_id
    ) 
;


ALTER TABLE Complementation 
    ADD CONSTRAINT providers_complementations FOREIGN KEY 
    ( 
     provider_id
    ) 
    REFERENCES Provider 
    ( 
     provider_id
    ) 
;


ALTER TABLE Service 
    ADD CONSTRAINT services_employees FOREIGN KEY 
    ( 
     employee_id
    ) 
    REFERENCES Employee 
    ( 
     employee_id
    ) 
;

CREATE OR REPLACE VIEW Company AS
SELECT Client.client_id,
  Client.additional_address,
  Client.street,
  Client.building_number,
  Client.apartment_number,
  Client.postal_code,
  Client.city,
  Client.phone_number,
  Client.email,
  Client.name,
  Client.nip
FROM Client ;



CREATE OR REPLACE VIEW Person AS
SELECT Client.client_id,
  Client.additional_address,
  Client.street,
  Client.building_number,
  Client.apartment_number,
  Client.postal_code,
  Client.city,
  Client.phone_number,
  Client.email,
  Client.first_name,
  Client.last_name,
  Client.pesel
FROM Client ;





-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            25
-- CREATE INDEX                             1
-- ALTER TABLE                             68
-- CREATE VIEW                              2
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE STRUCTURED TYPE                   0
-- CREATE COLLECTION TYPE                   0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
